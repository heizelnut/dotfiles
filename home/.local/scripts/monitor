#!/bin/sh

require dmenu xrandr || exit

set -x

main=eDP1
external=HDMI1
defaultMode=1366x768
secondGuess=1280x720

is_connected=$(xrandr | grep "$external connected")
[ "$is_connected" = "" ] && xrandr --output $main --mode $defaultMode --output $external --off && exit

choice=$(printf 'mirror\nprimary' | dmenu -p 'mode: ')

[ "$choice" = "mirror" ] && xrandr --output $main --mode $defaultMode && xrandr --output $external --mode $defaultMode --same-as $main || xrandr --output $external --mode $secondGuess --same-as $main
[ "$choice" = "primary" ] && xrandr --output $main --off --output $external --mode $defaultMode
